Это моя итоговая работа по курсу "Инженер данных".

По условиям задания необходимо провести анализ базы данных поездок такси в Нью-Йорке за январь 2020 года.

Исходные данные представляют собой таблицу из 18 столбцов и 6 405 009 строк.

На выходе необходимо получить таблицу с данными о процентном отношении поездок с различным количеством пассажиров
 к общему количеству поездок на каждый день месяца - поездки без пассажира, с одним, двумя, тремя пассажирами, и более трех.
 Также нужно добавить для каждой из групп максимальную и минимальную стоимость поездки в этот день. 
 Отдельно я проведен анализ зависимости количества чаевых от количества пассажиров и пройденного расстояния.

Для выполнения задания выбран Spark. Сам код писался на Scala в Jupiter. Исходный файл был загружен на HDFS.

На первом этапе я загрузил необходимые библиотеки, создал SparkSession, 
 создал структуру будущей базы данных и загрузил в нее данные из источника.

На втором этапе я провел очистку данных - удалил ненужные столбцы, строки не попадающие в диапазон января 2020 года,
 а также строки где значение чаевых не меньше 0, а стоимости и протяженности поездки меньше, либо равна 0.
 После очистки я получил таблицу из 5 столбцов и 6 316 818 строк 

Третий этап - преобразование данных.
	- создал отдельный датафрейм с общим количеством поездок за каждый день.
	- для каждой из групп пассажиров были выполнены следующие преобразования с очищенными данными:
		-- создан датафрейм с макс. и мин. стоимостью поездки на каждый день;
		-- создан датафрейм с количеством поездок на каждый день;
		-- объеденил датафреймы для расчетов при помощи join;
		-- преобразовал объединенный датафрейм в итоговый для каждой группы пассажиров.

На четвертом этапе я объеденил датафреймы каждой группы пассажиров в одну итоговую витрину.

В конце выгрузил итоговую витрину в формате .csv в HDFS.

Вывод некоторых таблиц в коде закоментирован, в случае необходимости их можно посмотреть.